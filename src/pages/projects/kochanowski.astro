---
import Layout from '../../layouts/Layout.astro';
import Header from '../../components/Header.astro'
import Footer from '../../components/Footer.astro';
import "../../styles/navigation.css"

export const title = "Kochanowski.js"
---

<Layout title={title}>
	<div id="background" class="alt">
        <main>
            <Header />
            
            <h1>{title}</h1>

            <section>
				<nav>
					<button id="translate">Translate</button>
					<button class="alt" id="compile">Compile</button>	
				</nav>

                <div class="compiler">
                    <h2>Kochanowski</h2>
                    <textarea class="font-mono" name="kochanowski" id="pol" spellcheck="false"></textarea>

                    <h2>JavaScript</h2>
                    <textarea class="font-mono" name="javascript" id="js" spellcheck="false" readonly></textarea>
                </div>
            </section>

            <Footer />
        </main>
    </div>
</Layout>

<style>
    textarea {
        width: 100%;
        background-color: rgba(var(--primary), 0.2);
        border: 0;
        border-radius: .2em;
        height: 30vh;
        color: rgb(var(--text));
        font-size: 1em;
        padding: 1em;
        box-sizing: border-box;
        resize: none;
    }

    section {
        margin-bottom: 4em;
    }
</style>

<script>
    "use strict";const x=[[",","."],["zacz","import"],["zwr贸","return"],["z biblioteki","from"],["brak","null"],["niezdefiniowane","undefined"],["fasz","false"],["prawda","true"],["funkcja","function"],["wyczekuj","await"],["klasa","class"],["konstruktor","constructor"],["je偶eli","if"],["jeli","if"],["w przeciwnym wypadku","else"],["dla","for"],["dop贸ki","while"],["r贸b","do"],["sr贸b贸j","try"],["ap","catch"],["zam","break"],["kontynuuj","continue"],["staej","const"],["staych","const"],["staym","const"],["stay","const"],["stae","const"],["staa","const"],["zmiennemu","let"],["zmiennej","let"],["zmienne","let"],["zmiennym","let"],["zmienny","let"],["zmienna","let"],["kt贸rej warto jest r贸wna","="],["kt贸ry warto jest r贸wna","="],["kt贸remu warto jest r贸wna","="],["gdzie warto jest r贸wna","="],["przypisz warto","="],["nie jest r贸wne","!="],["nie jest r贸wny","!="],["nie jest r贸wna","!="],["jest r贸wne","=="],["jest r贸wna","=="],["jest r贸wny","=="],["jest wiksze od",">"],["jest wiksza od",">"],["jest wikszy od",">"],["jest mniejsze od","<"],["jest mniejsza od","<"],["jest mniejszy od","<"],["jest mniejsza bd藕 r贸wna","<="],["jest mniejszy bd藕 r贸wny","<="],["jest mniejsze bd藕 r贸wne","<="],["jest wiksze bd藕 r贸wne",">="],["jest wikszy bd藕 r贸wny",">="],["jest wiksza bd藕 r贸wna",">="],["plus","+"],["doda","+"],["dodane do","+"],["minus","-"],["odj","-"],["odjte od","-"],["razy","*"],["pomno偶y przez","*"],["pomno偶one przez","*"],["pomno偶ona przez","*"],["podzieli na","/"],["podzielone na","/"],["podzielona na","/"],["podzielony na","/"],["do potgi","**"],["do kwadratu","**2"],["do szecianu","**3"],["kwadrat","**2"],["szecian","**3"],["pierwiastek","**0.5"],["ciasto","Math.PI"],["","Math.PI"],["","Math.PI"],["losowaLiczba","Math.random()"],["losowanie","Math.random()"],["modulowa na","%"],["modulowane na","%"],["modulowana na","%"],["modulowny na","%"],["zmodulowa na","%"],["zmodulowane na","%"],["zmodulowana na","%"],["zmodulowny na","%"],["zwiksz o","+="],["zmniejsz o","-="],["pomno偶 o","*="],["podziel o","/="],["moduluj o","%="],["zmoduluj o","%="],["z upchnitym","."],["to","this"],["drukuj","alert"],["wewntrz","in"],["oraz",","]],regex={m:/^[a-z]/,n:/\.(?=(?:(?:[^"]*"){2})*[^"]*$)/g,l:/.(?=(?:(?:[^"]*"){2})*[^"]*$)/g};function a(n){return n.split(regex.n).map((n=>n.trim())).filter(Boolean)}function b(n){for(let e of"\\^$*+?.()|{}[]")n=n.replaceAll(e,`\\${e}`);return n}function c(n){return RegExp(`${b(n)}(?=(?:(?:[^"]*"){2})*[^"]*$)`,"g")}function d(n,e){return(n.match(c(e))||[]).length}function convertToJs(n){let e=a(n);return g(e),h(e)}function h(n){for(let e in n=n.map((n=>k(n))))for(let o in x){let t=RegExp(`${x[o][0]}(?=([^"]*"[^"]*")*[^"]*$)`,"g");n[e]=n[e].replaceAll(t,x[o][1])}return n.join(";")+";"}function g(n){let e=["+","-","*","/","%"],o=[["[","]"],["{","}"],["(",")"]];for(let t=0;t<n.length;t++){if(n[t].match(regex.m))throw SyntaxError(`Bd w linii ${t+1}: Rozpoczynanie zda z maej litery (ort)`);for(let o of e)if(d(n[t],o))throw SyntaxError(`Bd w linii ${t+1}: U偶ywanie ang*elskich symboli (jz) (Symbol ${o})`);for(let e of o)if(d(n.join("\n"),e[0])!=d(n.join("\n"),e[1]))throw SyntaxError(`Bd w linii ${t+1}: Nie domykanie nawias贸w (sens)`)}}function k(n){return n.replaceAll(regex.l,(function(n){return n.toLocaleLowerCase()}))}
  
    const kochanowskiTextArea = document.getElementById("pol") as HTMLTextAreaElement;
    const javascriptTextArea = document.getElementById("js") as HTMLTextAreaElement;
    
    const translateBtn = document.getElementById("translate") as HTMLElement;
    const compileBtn = document.getElementById("compile") as HTMLElement;

    translateBtn.addEventListener("click", () => {
        let kochVer = kochanowskiTextArea.value;
    
        try {
          javascriptTextArea.value = convertToJs(kochVer);
        } catch (error: any) {
          javascriptTextArea.value = error;
        }
    });
  
    compileBtn.addEventListener("click", () => {
      eval(javascriptTextArea.value);
    });

</script>